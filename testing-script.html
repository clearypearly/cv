<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–µ—Ä API –¥–ª—è Make.com –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background: #ecf0f1;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #3498db;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            height: 120px;
            font-family: 'Courier New', monospace;
        }
        
        button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #219a52;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        
        .result.success {
            background: #d5f4e6;
            border: 1px solid #27ae60;
            color: #27ae60;
        }
        
        .result.error {
            background: #fdf2f2;
            border: 1px solid #e74c3c;
            color: #e74c3c;
        }
        
        .example-configs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .config-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }
        
        .config-card h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .config-card pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        
        .error-guide {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .error-guide h3 {
            color: #856404;
            margin-top: 0;
        }
        
        .checklist {
            background: #e8f5e8;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .checklist ul {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 5px 0;
            position: relative;
            padding-left: 25px;
        }
        
        .checklist li:before {
            content: "‚òê";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>üöÄ –¢–µ—Å—Ç–µ—Ä API –¥–ª—è Make.com –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h1>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showTab('gupshup-test')">–¢–µ—Å—Ç Gupshup API</button>
            <button class="tab" onclick="showTab('chatwoot-test')">–¢–µ—Å—Ç Chatwoot API</button>
            <button class="tab" onclick="showTab('examples')">–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</button>
            <button class="tab" onclick="showTab('troubleshooting')">–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</button>
        </div>
        
        <!-- Gupshup Test Tab -->
        <div id="gupshup-test" class="tab-content active">
            <h2>üîµ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Gupshup API</h2>
            <form id="gupshup-form">
                <div class="form-group">
                    <label for="gupshup-api-key">API Key Gupshup:</label>
                    <input type="text" id="gupshup-api-key" placeholder="–í–∞—à API –∫–ª—é—á Gupshup" required>
                </div>
                
                <div class="form-group">
                    <label for="gupshup-source">–ù–æ–º–µ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞:</label>
                    <input type="tel" id="gupshup-source" placeholder="919876543210" required>
                </div>
                
                <div class="form-group">
                    <label for="gupshup-destination">–ù–æ–º–µ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª—è:</label>
                    <input type="tel" id="gupshup-destination" placeholder="919876543211" required>
                </div>
                
                <div class="form-group">
                    <label for="gupshup-message">–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea id="gupshup-message" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" required>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ API —Ç–µ—Å—Ç–µ—Ä–∞</textarea>
                </div>
                
                <div class="form-group">
                    <label for="gupshup-app-name">–ò–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</label>
                    <input type="text" id="gupshup-app-name" value="TestApp" required>
                </div>
                
                <button type="submit">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
            </form>
            
            <div id="gupshup-result"></div>
        </div>
        
        <!-- Chatwoot Test Tab -->
        <div id="chatwoot-test" class="tab-content">
            <h2>üü¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Chatwoot API</h2>
            <form id="chatwoot-form">
                <div class="form-group">
                    <label for="chatwoot-domain">–î–æ–º–µ–Ω Chatwoot:</label>
                    <input type="url" id="chatwoot-domain" placeholder="https://your-domain.chatwoot.com" required>
                </div>
                
                <div class="form-group">
                    <label for="chatwoot-token">Access Token:</label>
                    <input type="text" id="chatwoot-token" placeholder="–í–∞—à access token" required>
                </div>
                
                <div class="form-group">
                    <label for="chatwoot-account-id">Account ID:</label>
                    <input type="number" id="chatwoot-account-id" placeholder="1" required>
                </div>
                
                <div class="form-group">
                    <label for="chatwoot-conversation-id">Conversation ID:</label>
                    <input type="number" id="chatwoot-conversation-id" placeholder="123" required>
                </div>
                
                <div class="form-group">
                    <label for="chatwoot-message">–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea id="chatwoot-message" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" required>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ API —Ç–µ—Å—Ç–µ—Ä–∞</textarea>
                </div>
                
                <button type="submit">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Chatwoot</button>
            </form>
            
            <div id="chatwoot-result"></div>
        </div>
        
        <!-- Examples Tab -->
        <div id="examples" class="tab-content">
            <h2>üìã –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</h2>
            
            <div class="example-configs">
                <div class="config-card">
                    <h3>üîµ Gupshup HTTP –º–æ–¥—É–ª—å</h3>
                    <p><strong>URL:</strong> https://api.gupshup.io/sm/api/v1/msg</p>
                    <p><strong>Method:</strong> POST</p>
                    <p><strong>Headers:</strong></p>
                    <pre>Content-Type: application/x-www-form-urlencoded
apikey: –í–ê–®_API_–ö–õ–Æ–ß</pre>
                    <p><strong>Body Type:</strong> application/x-www-form-urlencoded</p>
                    <p><strong>Fields:</strong></p>
                    <pre>channel: whatsapp
source: {{–Ω–æ–º–µ—Ä_–∏—Å—Ç–æ—á–Ω–∏–∫–∞}}
destination: {{–Ω–æ–º–µ—Ä_–ø–æ–ª—É—á–∞—Ç–µ–ª—è}}
message: {"type":"text","text":"{{—Ç–µ–∫—Å—Ç}}"}
src.name: –ò–º—è–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</pre>
                </div>
                
                <div class="config-card">
                    <h3>üü¢ Chatwoot HTTP –º–æ–¥—É–ª—å</h3>
                    <p><strong>URL:</strong> https://–¥–æ–º–µ–Ω/api/v1/accounts/{{account_id}}/conversations/{{conversation_id}}/messages</p>
                    <p><strong>Method:</strong> POST</p>
                    <p><strong>Headers:</strong></p>
                    <pre>Content-Type: application/json
api_access_token: –í–ê–®_–¢–û–ö–ï–ù</pre>
                    <p><strong>Body Type:</strong> application/json</p>
                    <p><strong>JSON Body:</strong></p>
                    <pre>{
  "content": "{{—Ç–µ–∫—Å—Ç_—Å–æ–æ–±—â–µ–Ω–∏—è}}",
  "message_type": "outgoing",
  "private": false
}</pre>
                </div>
            </div>
        </div>
        
        <!-- Troubleshooting Tab -->
        <div id="troubleshooting" class="tab-content">
            <h2>üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</h2>
            
            <div class="error-guide">
                <h3>‚ùå –û—à–∏–±–∫–∞ 415 "Unsupported Media Type"</h3>
                <p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type –∑–∞–≥–æ–ª–æ–≤–æ–∫</p>
                <p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
                <ul>
                    <li>–î–ª—è Gupshup: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>application/x-www-form-urlencoded</code></li>
                    <li>–î–ª—è Chatwoot: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>application/json</code></li>
                    <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</li>
                </ul>
            </div>
            
            <div class="error-guide">
                <h3>‚ùå –û—à–∏–±–∫–∞ 400 "Bad Request"</h3>
                <p><strong>–ü—Ä–∏—á–∏–Ω—ã:</strong></p>
                <ul>
                    <li>–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</li>
                    <li>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞</li>
                    <li>–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å</li>
                    <li>–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ —Ç–µ–∫—Å—Ç–µ</li>
                </ul>
                <p><strong>–†–µ—à–µ–Ω–∏—è:</strong></p>
                <ul>
                    <li>–§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞: <code>919876543210</code> (–±–µ–∑ +, –ø—Ä–æ–±–µ–ª–æ–≤, –¥–µ—Ñ–∏—Å–æ–≤)</li>
                    <li>–≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –∫–∞–≤—ã—á–∫–∏ –≤ JSON: <code>\"</code></li>
                    <li>–£–¥–∞–ª–∏—Ç–µ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞</li>
                </ul>
            </div>
            
            <div class="checklist">
                <h3>‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</h3>
                <ul>
                    <li>Content-Type –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ API</li>
                    <li>–í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç</li>
                    <li>–§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω</li>
                    <li>API –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã</li>
                    <li>JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π</li>
                    <li>–£–¥–∞–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞</li>
                    <li>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ Make.com</li>
                    <li>–í–∫–ª—é—á–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        // Gupshup form handler
        document.getElementById('gupshup-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const apiKey = document.getElementById('gupshup-api-key').value;
            const source = document.getElementById('gupshup-source').value;
            const destination = document.getElementById('gupshup-destination').value;
            const message = document.getElementById('gupshup-message').value;
            const appName = document.getElementById('gupshup-app-name').value;
            
            const resultDiv = document.getElementById('gupshup-result');
            resultDiv.innerHTML = '<p>üîÑ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...</p>';
            resultDiv.className = 'result';
            
            // Create form data
            const formData = new FormData();
            formData.append('channel', 'whatsapp');
            formData.append('source', source);
            formData.append('destination', destination);
            formData.append('message', JSON.stringify({"type":"text","text":message}));
            formData.append('src.name', appName);
            
            fetch('https://api.gupshup.io/sm/api/v1/msg', {
                method: 'POST',
                headers: {
                    'apikey': apiKey
                },
                body: formData
            })
            .then(response => {
                return response.text().then(text => {
                    return {
                        status: response.status,
                        statusText: response.statusText,
                        body: text
                    };
                });
            })
            .then(data => {
                if (data.status >= 200 && data.status < 300) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `‚úÖ –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!\n\n–°—Ç–∞—Ç—É—Å: ${data.status}\n–û—Ç–≤–µ—Ç: ${data.body}`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `‚ùå –û—à–∏–±–∫–∞ ${data.status}: ${data.statusText}\n\n–û—Ç–≤–µ—Ç: ${data.body}`;
                }
            })
            .catch(error => {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}\n\n–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n- CORS –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)\n- –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á\n- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Make.com`;
            });
        });
        
        // Chatwoot form handler  
        document.getElementById('chatwoot-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const domain = document.getElementById('chatwoot-domain').value;
            const token = document.getElementById('chatwoot-token').value;
            const accountId = document.getElementById('chatwoot-account-id').value;
            const conversationId = document.getElementById('chatwoot-conversation-id').value;
            const message = document.getElementById('chatwoot-message').value;
            
            const resultDiv = document.getElementById('chatwoot-result');
            resultDiv.innerHTML = '<p>üîÑ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...</p>';
            resultDiv.className = 'result';
            
            const url = `${domain}/api/v1/accounts/${accountId}/conversations/${conversationId}/messages`;
            
            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'api_access_token': token
                },
                body: JSON.stringify({
                    content: message,
                    message_type: 'outgoing',
                    private: false
                })
            })
            .then(response => {
                return response.text().then(text => {
                    return {
                        status: response.status,
                        statusText: response.statusText,
                        body: text
                    };
                });
            })
            .then(data => {
                if (data.status >= 200 && data.status < 300) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `‚úÖ –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!\n\n–°—Ç–∞—Ç—É—Å: ${data.status}\n–û—Ç–≤–µ—Ç: ${data.body}`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `‚ùå –û—à–∏–±–∫–∞ ${data.status}: ${data.statusText}\n\n–û—Ç–≤–µ—Ç: ${data.body}`;
                }
            })
            .catch(error => {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}\n\n–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n- CORS –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)\n- –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω\n- –ù–µ–≤–µ—Ä–Ω—ã–µ ID\n- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Make.com`;
            });
        });
    </script>
</body>
</html>